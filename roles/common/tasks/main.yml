---
# ============================================================
# COMMON ROLE
# Base Debian/Ubuntu setup for VM nodes (packages, guest agent)
# ============================================================

- name: "Common | Update apt cache and upgrade system packages"
  ansible.builtin.apt:
    update_cache: true
    upgrade: dist
    cache_valid_time: 3600

- name: "Common | Install base system packages"
  ansible.builtin.apt:
    name:
      - ca-certificates
      - curl
      - gnupg
      - git
      - htop
      - vim
      - qemu-guest-agent
      - net-tools
    state: present

- name: "Common | Ensure QEMU guest agent is running"
  ansible.builtin.systemd:
    name: qemu-guest-agent
    state: started
    enabled: true
